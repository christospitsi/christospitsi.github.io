<!DOCTYPE html>
<html lang="en-US">

<head>
<meta charset="utf-8">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer">
<meta name="description" content="Christos&#39;s Blog">


<meta property="og:site_name" content="  Christos Pitsikas" />
<meta property="og:locale" content="nn_NO" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://christospitsi.github.io/blog/cross-validation-on-a-simulated-dataset/" />
<meta property="og:title" content="Cross validation on a simulated dataset" />
<meta property="twitter:title" content="Cross validation on a simulated dataset">

    <meta property="og:image" content="https://christospitsi.github.io/img/banner.png">
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:image" content="https://christospitsi.github.io/img/banner.png">

<meta property="og:description" content="">
<meta property="twitter:description" content="">

<title>


       Christos Pitsikas - Cross validation on a simulated dataset 

</title>
<link rel="canonical" href="https://christospitsi.github.io/blog/cross-validation-on-a-simulated-dataset/">


<style media="screen">
  @font-face {
  font-family: 'Nexa Bold';
  src: url('https://christospitsi.github.io/fonts/Nexa Bold.otf');
}

html, body, div, span, applet, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
a, abbr, acronym, address, big, cite, code,
del, dfn, em, img, ins, kbd, q, s, samp,
small, strike, strong, sub, tt, var,
b, u, i, center,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td,
article, aside, canvas, details, embed,
figure, figcaption, footer, header, hgroup,
menu, nav, output, ruby, section, summary,
time, mark, audio, video {
  margin: 0;
  padding: 0;
  border: 0;
  font-size: 100%;
  font: inherit;
  vertical-align: baseline;
}
/* HTML5 display-role reset for older browsers */
article, aside, details, figcaption, figure,
footer, header, hgroup, menu, nav, section, div.column {
  display: block;
}
body {
  line-height: 1;
}
ol, ul {
  list-style: none;
}
blockquote, q {
  quotes: none;
}
blockquote:before, blockquote:after,
q:before, q:after {
  content: '';
  content: none;
}
table {
  border-collapse: collapse;
  border-spacing: 0;
}

*,
*:before,
*:after {
  box-sizing: border-box;
}
a,
a:visited,
a:focus,
a:active {
  text-decoration: none;
}
html {
  height: 100%;
  font-size: 16px;
}
body {
  display: -webkit-flex;
  display: -moz-flex;
  display: -ms-flexbox;
  display: -ms-flex;
  display: flex;
  -webkit-flex-direction: column;
  -moz-flex-direction: column;
  -ms-flex-direction: column;
  flex-direction: column;
  -webkit-align-items: center;
  -moz-align-items: center;
  -ms-align-items: center;
  align-items: center;
  -webkit-justify-content: flex-start;
  -moz-justify-content: flex-start;
  -ms-justify-content: flex-start;
  justify-content: flex-start;
  width: 100%;
  min-height: 100%;
  font-weight: 400;
  font-family: 'Helvetica Neue', 'Arial', sans-serif;
  color: #111111;
  line-height: 1.6;
  text-rendering: optimizeLegibility !important;
}
.icon {
  text-rendering: geometricPrecision !important;
}
section {
  display: -webkit-flex;
  display: -moz-flex;
  display: -ms-flexbox;
  display: -ms-flex;
  display: flex;
  -webkit-justify-content: center;
  -moz-justify-content: center;
  -ms-justify-content: center;
  justify-content: center;
  -webkit-align-items: center;
  -moz-align-items: center;
  -ms-align-items: center;
  align-items: center;
  width: 100%;
}
div.column {
  display: -webkit-flex;
  display: -moz-flex;
  display: -ms-flexbox;
  display: -ms-flex;
  display: flex;
  -webkit-justify-content: center;
  -moz-justify-content: center;
  -ms-justify-content: center;
  justify-content: center;
  -webkit-align-items: center;
  -moz-align-items: center;
  -ms-align-items: center;
  align-items: center;
  width: 100%;
}
.container {
  display: -webkit-flex;
  display: -moz-flex;
  display: -ms-flexbox;
  display: -ms-flex;
  display: flex;
  width: 100%;
}
div.header .container {
  -webkit-align-items: center;
  -moz-align-items: center;
  -ms-align-items: center;
  align-items: center;
  -webkit-justify-content: center;
  -moz-justify-content: center;
  -ms-justify-content: center;
  justify-content: center;
}
div.header .content {
  display: -webkit-flex;
  display: -moz-flex;
  display: -ms-flexbox;
  display: -ms-flex;
  display: flex;
  -webkit-flex-direction: column;
  -moz-flex-direction: column;
  -ms-flex-direction: column;
  flex-direction: column;
  -webkit-align-items: center;
  -moz-align-items: center;
  -ms-align-items: center;
  align-items: center;
}
div.header .container .logo {
  max-width: 100px;
  margin-left: -2em;
}
div.header .name {
  padding-top: 20px;
  font-size: 28px;
  font-family: 'Nexa Bold', 'Helvetica Neue', 'Arial', sans-serif;
  letter-spacing: -0.005rem;
  text-transform: uppercase;
  -moz-osx-font-smoothing: grayscale;
  -webkit-font-smoothing: antialiased;
  font-smoothing: antialiased;
  color: #333333;
  color: #555555;
}
div.header nav {
  margin-bottom: 16px;
}
div.header nav ul {
  list-style: none;
  text-align: center;
  display: -webkit-inline-flex;
  display: -moz-inline-flex;
  display: -ms-inline-flexbox;
  display: -ms-inline-flex;
  display: inline-flex;
}
div.header nav ul li {
  margin-left: 6px;
  margin-right: 6px;
}
div.header nav ul li:first-child {
  margin-left: 0;
}
div.header nav ul li:last-child {
  margin-right: 0;
}
div.header nav ul a {
  color: #555555;
  font-weight: 400;
  font-size: 14px;
  text-transform: uppercase;
  font-family: 'Helvetica Neue', 'Arial', sans-serif;
  -webkit-transition: color 0.1s cubic-bezier(0.47, 0, 0.75, 0.72);
  -moz-transition: color 0.1s cubic-bezier(0.47, 0, 0.75, 0.72);
  -ms-transition: color 0.1s cubic-bezier(0.47, 0, 0.75, 0.72);
  -o-transition: color 0.1s cubic-bezier(0.47, 0, 0.75, 0.72);
}
div.header nav ul a:hover {
  color: #111111;
}
div.footer .container {
  -webkit-align-items: center;
  -moz-align-items: center;
  -ms-align-items: center;
  align-items: center;
  -webkit-justify-content: center;
  -moz-justify-content: center;
  -ms-justify-content: center;
  justify-content: center;
  flex-direction: column-reverse;
  width: 100%;
  text-align: center;
}
div.footer .container a {
  font-size: 14px;
  margin-left: 6px;
  margin-right: 6px;
  opacity: 0.6;
  -webkit-transition: opacity 0.1s cubic-bezier(0.47, 0, 0.75, 0.72);
  -moz-transition: opacity 0.1s cubic-bezier(0.47, 0, 0.75, 0.72);
  -ms-transition: opacity 0.1s cubic-bezier(0.47, 0, 0.75, 0.72);
  -o-transition: opacity 0.1s cubic-bezier(0.47, 0, 0.75, 0.72);
}
div.footer .container a:first-child {
  margin-left: 0;
}
div.footer .container a:last-child {
  margin-right: 0;
}
div.footer .container a:hover {
  opacity: 0.8;
}
div.footer .container a .icon {
  width: 16px;
  height: 16px;
}
div.footer .container .copyright {
  flex-grow: 0.5;
  text-align: start;
}
div.footer .container .icons {
  flex-grow: 0.5;
  text-align: end;
}
div.main .container {
  -webkit-align-items: center;
  -moz-align-items: center;
  -ms-align-items: center;
  align-items: center;
  -webkit-justify-content: flex-start;
  -moz-justify-content: flex-start;
  -ms-justify-content: flex-start;
  justify-content: flex-start;
}
div.main .content {
  color: #111111;
  font-size: 16px;
}
div.main .content .title-container {
  display: -webkit-flex;
  display: -moz-flex;
  display: -ms-flexbox;
  display: -ms-flex;
  display: flex;
  -webkit-justify-content: space-between;
  -moz-justify-content: space-between;
  -ms-justify-content: space-between;
  justify-content: space-between;
}
div.main .content .posts {
  margin-bottom: 4em;
}
div.main .content .page-heading {
  font-size: 20px;
  font-weight: 700;
  font-family: 'Helvetica Neue', 'Arial', sans-serif;
  letter-spacing: -0.005rem;
  text-transform: uppercase;
  -moz-osx-font-smoothing: grayscale;
  -webkit-font-smoothing: antialiased;
  font-smoothing: antialiased;
  color: #333333;
  margin-bottom: 16px;
}
div.main .content .front-matter .page-heading {
  margin-bottom: 0;
}
div.main .content .front-matter .meta {
  font-size: 14px;
  color: #666666;
  display: -webkit-flex;
  display: -moz-flex;
  display: -ms-flexbox;
  display: -ms-flex;
  display: flex;
  margin-bottom: 32px;
}
div.main .content .front-matter .date,
div.main .content .front-matter .author,
div.main .content .front-matter .tags,
div.main .content .front-matter .word-count,
div.main .content .front-matter .middot:before {
  display: none;
}
div.main .content .front-matter .middot:before {
  font-size: 6px;
  margin: 0 6px;
  vertical-align: middle;
  content: "•";
}
div.main .content .front-matter .tags ul {
  display: -webkit-flex;
  display: -moz-flex;
  display: -ms-flexbox;
  display: -ms-flex;
  display: flex;
  -webkit-flex-direction: row;
  -moz-flex-direction: row;
  -ms-flex-direction: row;
  flex-direction: row;
  -webkit-align-items: center;
  -moz-align-items: center;
  -ms-align-items: center;
  align-items: center;
}
div.main .content .front-matter .tags ul li {
  -webkit-transition: opacity 0.1s cubic-bezier(0.47, 0, 0.75, 0.72);
  -moz-transition: opacity 0.1s cubic-bezier(0.47, 0, 0.75, 0.72);
  -ms-transition: opacity 0.1s cubic-bezier(0.47, 0, 0.75, 0.72);
  -o-transition: opacity 0.1s cubic-bezier(0.47, 0, 0.75, 0.72);
}
div.main .content .front-matter .tags ul li:hover {
  opacity: 0.7;
}
div.main .content .front-matter .tags ul li a {
  color: #666666;
}
div.main .container.f04 {
  -webkit-justify-content: center;
  -moz-justify-content: center;
  -ms-justify-content: center;
  justify-content: center;
}
div.main .container.f04 .content {
  display: -webkit-flex;
  display: -moz-flex;
  display: -ms-flexbox;
  display: -ms-flex;
  display: flex;
  -webkit-flex-direction: column;
  -moz-flex-direction: column;
  -ms-flex-direction: column;
  flex-direction: column;
  -webkit-align-items: center;
  -moz-align-items: center;
  -ms-align-items: center;
  align-items: center;
}
div.main .container.f04 .content .num {
  margin: 30px 0px 30px 0;
  font-weight: 400;
  font-family: 'Helvetica Neue', 'Arial', sans-serif;
  font-size: 50px;
}
div.main .container.f04 .content .detail {
  margin-bottom: 40px;
}
div.main .container .content .groupby {
  margin-top: 1em;
  padding-left: 0.5em;
}
div.main .container .content .post-item {
  display: -webkit-flex;
  display: -moz-flex;
  display: -ms-flexbox;
  display: -ms-flex;
  display: flex;
  -webkit-align-items: center;
  -moz-align-items: center;
  -ms-align-items: center;
  align-items: center;
  display: list-item;
  list-style: disc inside;
}
div.main .container .content .post-item .meta {
  font-size: 14px;
  color: #666666;
  display: none;
  min-width: 100px;
}
div.main .container .content .see-more {
  font-style: italic;
  float: right;
  font-size: 0.9em;
  margin-top: 2em;
  color: #313537;
}
div.main .container .content .see-more:hover {
  color: #666;
}
section {
  padding: 0 16px;
}
div.column {
  padding: 0 16px;
}
div.header {
  padding-top: 10px;
}
div.header-home {
  padding-top: 36px;
}
div.main {
  padding-top: 32px;
}
div.main .container .content .post-item .meta {
    display: block;
}
div.main .container .content .post-item {
    display: flex;
    list-style: none;
}
a {
  color: #428bca;
  -webkit-transition: color 0.1s cubic-bezier(0.47, 0, 0.75, 0.72);
  -moz-transition: color 0.1s cubic-bezier(0.47, 0, 0.75, 0.72);
  -ms-transition: color 0.1s cubic-bezier(0.47, 0, 0.75, 0.72);
  -o-transition: color 0.1s cubic-bezier(0.47, 0, 0.75, 0.72);
}
a:hover {
  color: #2a6496;
}
img {
  max-width: 100%;
}
div.main .content {
    width: 100%;
}
div.main .content .markdown {
  font-size: 1.1em;
  line-height: 1.75em;
  color: #313537;
  font-family: serif;
  font-weight: 300;
}
div.main .content .markdown h1,
div.main .content .markdown h2,
div.main .content .markdown h3,
div.main .content .markdown h4,
div.main .content .markdown h5,
div.main .content .markdown h6 {
  font-size: 22px;
  font-family: 'Helvetica Neue', 'Arial', sans-serif;
  letter-spacing: -0.005rem;
  font-weight: 700;
  -moz-osx-font-smoothing: grayscale;
  -webkit-font-smoothing: antialiased;
  font-smoothing: antialiased;
  color: #333333;
  text-transform: none;
  margin-top: 1.75rem;
}
div.main .content .markdown h1 {
  font-size: 1.75rem;
  margin-bottom: 2rem;
}
div.main .content .markdown h2 {
  font-size: 1.5rem;
  margin-bottom: 1.5rem;
}
div.main .content .markdown h3 {
  font-size: 1em;
  margin-bottom: 1rem;
}
div.main .content .markdown h4,
div.main .content .markdown h5,
div.main .content .markdown h6 {
  font-size: 1rem;
  margin-bottom: 1rem;
  letter-spacing: none;
}
div.main .content .markdown code,
div.main .content .markdown pre {
  font-family: 'Menlo', monospace;
  font-size: 0.98rem;
  background-color: #f7f7f7;
}
div.main .content .markdown code {
  /* enclosed by single backtick (`) */
  padding: .15em .5em;
  border-radius: 2px;
}
div.main .content .markdown pre {
  /* Hugo specific: consider using the 'highlight' shortcode */
  display: block;
  margin-top: 1rem;
  margin-bottom: 2rem;
  padding: 1rem;
  line-height: 1.5em;
  white-space: pre;
  word-break: break-all;
  word-wrap: break-word;
}
div.main .content .markdown pre code {
  /* enclosed by 4 backticks (````) */
  padding: 0;
  font-size: 0.9rem;
}
div.main .content .markdown a code {
  color: #428bca !important;
}
div.main .content .markdown a code:hover {
  text-decoration: underline;
}
div.main .content .markdown p {
  
  text-align: justify;
  
  margin-top: 0;
  margin-bottom: 1em;
}
div.main .content .markdown ul,
div.main .content .markdown ol,
div.main .content .markdown dl {
  margin-top: 1rem;
  margin-bottom: 2rem;
}
div.main .content .markdown dt {
  font-weight: bold;
}
div.main .content .markdown dd {
  margin-bottom: .5rem;
}
div.main .content .markdown ul {
  list-style-type: disc;
  list-style-position: outside;
  margin-bottom: 1.25rem;
}
div.main .content .markdown ol {
  list-style-type: decimal;
  margin-bottom: 1.25rem;
}
div.main .content .markdown li {
  margin-left: 2em;
}
div.main .content .markdown em {
  font-style: italic;
}
div.main .content .markdown strong {
  font-weight: 700;
}
div.main .content .markdown hr {
  position: relative;
  margin: 1.75rem 0;
  border: 0;
  border-top: 1px solid #808080;
  border-top: 1px solid #999999;
}
div.main .content .markdown abbr {
  font-size: 0.85rem;
  font-weight: bold;
  color: #666666;
  text-transform: uppercase;
}
div.main .content .markdown abbr[title] {
  cursor: help;
  border-bottom: 1px dotted #808080;
}
div.main .content .markdown blockquote {
  padding: .5rem 1rem;
  margin: .8rem 0;
  color: #7a7a7a;
  border-left: .25rem solid #e5e5e5;
}
div.main .content .markdown blockquote p:last-child {
  margin-bottom: 0;
}
div.main .content .markdown figure {
  width: 100%;
  background: #fff;
  margin-bottom: 1em;
}
div.main .content .markdown figure img {
  width: 100%;
  height: auto;
  max-width: 100%;
  display: block;
  position: static;
  margin: auto;
}
div.main .content .markdown table {
  margin-bottom: 1rem;
  width: 100%;
  border: 1px solid #e5e5e5;
  border-collapse: collapse;
}
div.main .content .markdown td,
div.main .content .markdown th {
  padding: .25rem .5rem;
  border: 1px solid #e5e5e5;
}
div.main .content .markdown tbody tr:nth-child(odd) td,
div.main .content .markdown tbody tr:nth-child(odd) th {
  background-color: #f7f7f7;
}
div.main .content .markdown .footnotes ol {
  list-style-type: decimal;
  margin-left: 16px;
}
div.main .content .markdown .footnotes li {
  list-style-type: unset;
}
div.main .content .markdown .footnote-ref {
  font-size: 0.7em;
}
div.main .content .navigation {
  display: -webkit-flex;
  display: -moz-flex;
  display: -ms-flexbox;
  display: -ms-flex;
  display: flex;
  -webkit-flex-direction: column;
  -moz-flex-direction: column;
  -ms-flex-direction: column;
  flex-direction: column;
  -webkit-align-items: center;
  -moz-align-items: center;
  -ms-align-items: center;
  align-items: center;
  padding: 2em;
}
div.main .content .navigation div {
  display: -webkit-flex;
  display: -moz-flex;
  display: -ms-flexbox;
  display: -ms-flex;
  display: flex;
  -webkit-flex-direction: row;
  -moz-flex-direction: row;
  -ms-flex-direction: row;
  flex-direction: row;
  -webkit-align-items: center;
  -moz-align-items: center;
  -ms-align-items: center;
  align-items: center;
  margin-top: 1em;
}
div.main .content .navigation .icon {
  width: 16px;
  height: 16px;
}
div.main .content .navigation a {
  width: 250px;
  margin: 0 1em;
  text-align: center;
  font-style: italic;
  color: #313537;
}
div.main .content .share, div.main .content .share div {
  display: -webkit-flex;
  display: -moz-flex;
  display: -ms-flexbox;
  display: -ms-flex;
  display: flex;
  -webkit-flex-direction: row;
  -moz-flex-direction: row;
  -ms-flex-direction: row;
  flex-direction: row;
  -webkit-align-items: center;
  -moz-align-items: center;
  -ms-align-items: center;
  align-items: center;
  justify-content: center;
}
div.main .content .share {
  background-color: rgba(152, 152, 152, 0.07);
  padding: 1em 0;
}
div.main .content .share a {
  margin: 0 6px;
}

/* Fonts */

.wf-raleway-n4-active body, 
.wf-raleway-n4-active div.header nav ul a,
.wf-raleway-n7-active div.main .content .page-heading,
.wf-raleway-n2-active div.main .container.f04 .content .num,
.wf-raleway-n7-active div.main .content .markdown h1,
.wf-raleway-n7-active div.main .content .markdown h2,
.wf-raleway-n7-active div.main .content .markdown h3,
.wf-raleway-n7-active div.main .content .markdown h4,
.wf-raleway-n7-active div.main .content .markdown h5,
.wf-raleway-n7-active div.main .content .markdown h6 {
  font-family: 'Raleway';
}

.wf-merriweather-n3-active div.main .content .markdown {
  font-family: 'Merriweather';
}

.wf-ubuntu-mono-n4-active div.main .content .markdown code,
.wf-ubuntu-mono-n4-active div.main .content .markdown pre {
  font-family: 'Ubuntu Mono';
}

</style>
<style media="(min-width: 600px)">
  body {
-webkit-justify-content: center;
-moz-justify-content: center;
-ms-justify-content: center;
justify-content: center;
}
.non-narrow.zero-top-spacing {
padding-top: 0 !important;
}
section {
padding: 0 16px;
margin-left: 100px;
margin-right: 100px;
max-width: 750px;
}
div.column {
padding: 0 16px;
margin-left: 100px;
margin-right: 100px;
max-width: 750px;
}
div.header {
background-color: transparent;
}
div.header .container {
-webkit-justify-content: flex-start;
-moz-justify-content: flex-start;
-ms-justify-content: flex-start;
justify-content: flex-start;
}
div.header .container .logo {
margin: 0;
}
div.header-home .container .logo {
max-width: 180px;
margin-left: 20px;
}
div.header-home .name-home {
padding-top: 30px;
font-size: 40px;
}
div.header-home nav ul a {
font-size: 18px;
}
div.header .content {
-webkit-align-items: flex-start;
-moz-align-items: flex-start;
-ms-align-items: flex-start;
align-items: flex-start;
}
div.header .name {
color: #333333;
}
div.header nav {
font-size: 14px;
margin-bottom: 0;
}
div.header nav ul {
text-align: left;
}
div.header nav ul a {
color: #666666;
}
div.header nav ul a:hover {
color: #333333;
}
div.footer {
background-color: transparent;
}
div.footer .container {
flex-direction: row;
}
div.footer .container a {
margin-left: 3px;
margin-right: 3px;
color: #666666;
}
div.footer .container a:hover {
color: #333333;
}
div.footer .container a .icon {
font-size: 18px;
}
div.footer .container a .icon.larger {
font-size: 20px;
}
div.main .content .front-matter .date,
div.main .content .front-matter .author,
div.main .content .front-matter .tags,
div.main .content .front-matter .word-count,
div.main .content .front-matter .middot:before {
display: initial;
}
div.main .container.f04 {
-webkit-justify-content: flex-start;
-moz-justify-content: flex-start;
-ms-justify-content: flex-start;
justify-content: flex-start;
}
div.main .container.f04 .content {
-webkit-align-items: flex-start;
-moz-align-items: flex-start;
-ms-align-items: flex-start;
align-items: flex-start;
}
div.main .container.f04 .content .num {
margin: 0 0 10px 0;
font-size: 32px;
}
div.main .container.f04 .content .detail {
margin-bottom: 30px;
}
.container {
padding: 0 30px;
}
div.header {
padding-top: 60px;
padding-bottom: 60px;
}
div.footer {
padding-top: 30px;
padding-bottom: 60px;
}
div.main {
padding-top: 0;
}
div.main .container .content .post-item {
display: flex;
list-style: none;
padding-left: 1.5em;
}
div.main .container .content .post-item .meta {
display: block;
}
div.main.post {
padding-top: 60px;
padding-bottom: 60px;
}
div.main .content .markdown blockquote {
padding-right: 5rem;
padding-left: 1.25rem;
}
div.main .content .navigation {
-webkit-flex-direction: row;
-moz-flex-direction: row;
-ms-flex-direction: row;
flex-direction: row;
}
div.main .content .navigation div {
margin-top: 0em;
}

</style>
<style media="(min-width: 769px)">
  div.main .content .markdown figure {
width: 110%;
margin-left: -4%;
}
div.main .content .markdown img {
max-width: 110%;
width: 110%;
margin-left: -4%;
}
div.main .content .markdown pre {
width: 110%;
margin-left: -4%;
}

</style>

<noscript>
  <link href="https://fonts.googleapis.com/css?family=Raleway:400,600,700" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Merriweather:300,300i,700,700i" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700" rel="stylesheet">
</noscript>


  <style type="text/css" media="screen">
    .hljs{display:block;background:white;padding:0.5em;color:#333333;overflow-x:auto}.hljs-comment,.hljs-meta{color:#969896}.hljs-string,.hljs-variable,.hljs-template-variable,.hljs-strong,.hljs-emphasis,.hljs-quote{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#a71d5d}.hljs-literal,.hljs-symbol,.hljs-bullet,.hljs-attribute{color:#0086b3}.hljs-section,.hljs-name{color:#63a35c}.hljs-tag{color:#333333}.hljs-title,.hljs-attr,.hljs-selector-id,.hljs-selector-class,.hljs-selector-attr,.hljs-selector-pseudo{color:#795da3}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}
  </style>



  <style type="text/css" media="screen">
    .progressive{overflow:hidden;position:relative;background:#efefef}.progressive__img{width:100%;height:100%;position:absolute;-webkit-transform:translateZ(0);transform:translateZ(0)}.progressive--not-loaded{filter:blur(30px);-webkit-filter:blur(30px)}.progressive--is-loaded{filter:blur(20px);-webkit-filter:blur(20px);-webkit-animation:sharpen .5s both;animation:sharpen .5s both}@-webkit-keyframes sharpen{from{filter:blur(20px);-webkit-filter:blur(20px)}to{filter:blur(0);-webkit-filter:blur(0)}}@keyframes sharpen{from{filter:blur(20px);-webkit-filter:blur(20px)}to{filter:blur(0);-webkit-filter:blur(0)}}
  </style>











<link rel="shortcut icon"

    href="https://christospitsi.github.io/img/favicon.ico"

>


    <a href="https://github.com/christospitsi" target="_blank">
        <img class="icon" src="https://christospitsi.github.io/img/github.svg" alt="github" />
    </a>






</head>


<body>


<div class="header column">


    <div class="container">
        <a href="https://christospitsi.github.io/"><img class="logo" src="https://christospitsi.github.io/img/logo.png" alt="logo" /></a>
        <div class="content">
            <a href="https://christospitsi.github.io/"><div class="name"><h1>  Christos Pitsikas</h1></div></a>
            <nav>
                <ul>
                    
                        <li><a href="https://christospitsi.github.io/blog/">Blog</a></li>
                    
                    
                        
                            
                        
                    
                        
                            
                            <li><a href="https://christospitsi.github.io/projects">projects</a></li>
                            
                        
                    

                    
                        
                            <li><a href="https://christospitsi.github.io/about/">About</a></li>
                        
                    
                        
                    
                </ul>
            </nav>
        </div>
    </div>
</div>


<div class="main post non-narrow zero-top-spacing column">
    <div class="container">
        <div class="content">
            <div class="front-matter">
                <div class="title-container">
                    <div class="page-heading">

    Cross validation on a simulated dataset

</div>

                </div>
                <div class="meta">
                    <div class="date" title="Mon Oct 30 2017 10:06:06 UTC">Oct 30, 2017</div>
                    
                        
                    
                    <div class="reading-time middot">4 minute read</div>
                    <div class="tags">
                        <ul>
                          
                            <li class="middot"><a href="https://christospitsi.github.io/tags/r">R</a> </li>
                          
                            <li class="middot"><a href="https://christospitsi.github.io/tags/statistical-learning">Statistical Learning</a> </li>
                          
                        </ul>
                    </div>
                    <div class="tags">
                        <ul>
                          
                          
                        </ul>
                    </div>
                </div>
            </div>
            <div class="markdown">
                
    
    <p>For the purposes of this exercise,
we generate the simulated data using the below equation:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">set.seed</span>(<span style="color:#ae81ff">1</span>)
x <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">rnorm</span>(<span style="color:#ae81ff">100</span>)
y <span style="color:#f92672">&lt;-</span> x <span style="color:#ae81ff">-2</span><span style="color:#f92672">*</span>x^2 <span style="color:#f92672">+</span> <span style="color:#a6e22e">rnorm</span>(<span style="color:#ae81ff">100</span>)
</code></pre></div><p>Our data set consists of 100 values for x (n = 100) and one predictor (p = 1) The function for the calculation of <em>y</em> is of the below form:</p>
<p>Y = β<!-- raw HTML omitted -->0<!-- raw HTML omitted --> + β<!-- raw HTML omitted -->1<!-- raw HTML omitted -->X + β<!-- raw HTML omitted -->2<!-- raw HTML omitted -->X<!-- raw HTML omitted -->2<!-- raw HTML omitted --> + ϵ.
In our example, β<!-- raw HTML omitted -->0<!-- raw HTML omitted --> = 0, β<!-- raw HTML omitted -->1<!-- raw HTML omitted --> = 1, β<!-- raw HTML omitted -->2<!-- raw HTML omitted --> = −2
and the error is a randomly generated number.</p>
<p>On the following plot of X against Y we can see that the points seem to have a <em>quadratic</em> shape which was what we expected since we used a quadratic equation to calculate the y values.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">plot</span>(x, y, col <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;coral2&#34;</span>,
    xlab <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;X&#34;</span>, ylab <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Y&#34;</span>,
    type <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;p&#34;</span>, pch <span style="color:#f92672">=</span> <span style="color:#ae81ff">20</span>, cex.axis <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.8</span>, cex.lab <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.8</span>)
</code></pre></div><!-- raw HTML omitted -->
<h3 id="loocv">LOOCV</h3>
<p>We will now calculate the LOOCV test errors for the following models
using least squares:</p>
<p>i. Y = β<!-- raw HTML omitted -->0<!-- raw HTML omitted --> + β<!-- raw HTML omitted -->1<!-- raw HTML omitted -->X + ϵ<!-- raw HTML omitted -->
ii. Y = β<!-- raw HTML omitted -->0<!-- raw HTML omitted --> + β<!-- raw HTML omitted -->1<!-- raw HTML omitted -->X + β<!-- raw HTML omitted -->2<!-- raw HTML omitted -->X<!-- raw HTML omitted -->2<!-- raw HTML omitted --> + ϵ<!-- raw HTML omitted -->
iii. Y = β<!-- raw HTML omitted -->0<!-- raw HTML omitted --> + β<!-- raw HTML omitted -->1<!-- raw HTML omitted -->X + β<!-- raw HTML omitted -->2<!-- raw HTML omitted -->X<!-- raw HTML omitted -->2<!-- raw HTML omitted --> + β<!-- raw HTML omitted -->3<!-- raw HTML omitted -->X<!-- raw HTML omitted -->3<!-- raw HTML omitted --> + ϵ<!-- raw HTML omitted -->
iv. Y = β<!-- raw HTML omitted -->0<!-- raw HTML omitted --> + β<!-- raw HTML omitted -->1<!-- raw HTML omitted -->X + β<!-- raw HTML omitted -->2<!-- raw HTML omitted -->X<!-- raw HTML omitted -->2<!-- raw HTML omitted --> + 
β<!-- raw HTML omitted -->3<!-- raw HTML omitted -->X<!-- raw HTML omitted -->3<!-- raw HTML omitted --> + β<!-- raw HTML omitted -->4<!-- raw HTML omitted -->X<!-- raw HTML omitted -->4<!-- raw HTML omitted --> + ϵ</p>
<p>We create a data frame with all values of x and y and
a vector <code>ls.error</code> which will store the error values for the different models.
Finally,
using a for loop and function <code>cv.glm()</code> from <code>boot</code> library,
we calculate the LOOCV estimates for the test MSE of each model.</p>
<p>We can see on the generated plot with the calculated errors that
there is a sharp drop between the linear and quadratic fits
(models i. and ii. respectively).
Moreover, it appears that the use of higher order polynomials
does not improve the accuracy of the model (models iii. and iv.)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">library</span>(boot)
<span style="color:#a6e22e">set.seed</span>(<span style="color:#ae81ff">1</span>)
df <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">data.frame</span>(y, x)

ls.error <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">rep</span>(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">4</span>)

<span style="color:#a6e22e">for </span>(i in <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">4</span>){
  glm.fit <span style="color:#f92672">=</span> <span style="color:#a6e22e">glm</span>(y<span style="color:#f92672">~</span><span style="color:#a6e22e">poly</span>(x, i), data <span style="color:#f92672">=</span> df)
  ls.error[i] <span style="color:#f92672">=</span> <span style="color:#a6e22e">cv.glm</span>(df, glm.fit)<span style="color:#f92672">$</span>delta[1]
}
ls.error
</code></pre></div><pre><code>## [1] 7.2881616 0.9374236 0.9566218 0.9539049
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">plot</span>(ls.error, col <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;coral2&#34;</span>,
    xlab <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Polynomial Order&#34;</span>,
    ylab <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Test MSE&#34;</span>,
    type <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;p&#34;</span>, pch <span style="color:#f92672">=</span> <span style="color:#ae81ff">20</span>,
    xaxp <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">1</span>))

<span style="color:#a6e22e">axis</span>(<span style="color:#ae81ff">1</span>, at <span style="color:#f92672">=</span> <span style="color:#a6e22e">seq</span>(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>))
<span style="color:#a6e22e">lines</span>(ls.error, type <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;o&#34;</span>, col <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;coral2&#34;</span>)
</code></pre></div><!-- raw HTML omitted -->
<h3 id="loocv-and-randomness">LOOCV and randomness</h3>
<p>As we explained earlier,
<em>Leave-One-Out Cross Validation (LOOCV)</em>
keeps a single observation to be used as validation set.
This procedure is repeated n times,
using each time a different observation for testing.</p>
<p>In general, the seed value in R has an effect on all functions
which use some kind of randomness to perform their calculations.
In our calculations above,
we defined at the beginning of the function the seed to be 1.</p>
<p>Function <code>cv.glm()</code> estimates the test error
using individual observations as validation set,
one at a time,
picked in random order based on the seed value thus
a different seed will have as a result a different picking order.</p>
<p>We now re-run the above code using a different <code>set.seed</code> argument.
As we can see, the estimated test MSEs for all models are the same
regardless the seed value since
we use all observations as validation sets and
the order does not matter.</p>
<p>It is worth noting that a different seed
would have an effect on the test MSE calculation
if we used other cross-validation approaches such as <em>Validation Set</em>
where we don&rsquo;t use all observations to test the trained models.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">library</span>(boot)
<span style="color:#a6e22e">set.seed</span>(<span style="color:#ae81ff">5</span>)
df <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">data.frame</span>(y, x)

ls.error <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">rep</span>(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">4</span>)

<span style="color:#a6e22e">for </span>(i in <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">4</span>){
  glm.fit <span style="color:#f92672">=</span> <span style="color:#a6e22e">glm</span>(y <span style="color:#f92672">~</span> <span style="color:#a6e22e">poly</span>(x, i), data <span style="color:#f92672">=</span> df)
  ls.error[i] <span style="color:#f92672">=</span> <span style="color:#a6e22e">cv.glm</span>(df, glm.fit)<span style="color:#f92672">$</span>delta[1]
}
ls.error
</code></pre></div><pre><code>## [1] 7.2881616 0.9374236 0.9566218 0.9539049
</code></pre>
<p>The calculated error values show that
the most accurate model with the smallest <em>LOOCV error</em> (0.9374)
was the one shown below.
This confirms our expectations since this model approaches the form of the real equation used to generate the simulated data set.</p>
<p>Y = β<!-- raw HTML omitted -->0<!-- raw HTML omitted --> + β<!-- raw HTML omitted -->1<!-- raw HTML omitted -->X + β<!-- raw HTML omitted -->2<!-- raw HTML omitted -->X<!-- raw HTML omitted -->2<!-- raw HTML omitted --> + ϵ</p>
<p>Statistical significance of the coefficient estimates</p>
<p>We now print the fourth column
in order to assess the <em>P-Values</em> for the coefficients of each model.
As we can see, the P-Values for the calculated β<!-- raw HTML omitted -->0<!-- raw HTML omitted -->,
β<!-- raw HTML omitted -->1<!-- raw HTML omitted --> and β<!-- raw HTML omitted -->2<!-- raw HTML omitted --> are sufficiently small so
we can claim that they are significant whereas
the values for the rest of the coefficients
have relatively large values ( &gt;0.05), thus they are insignificant.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">library</span>(boot)
<span style="color:#a6e22e">set.seed</span>(<span style="color:#ae81ff">1</span>)
df <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">data.frame</span>(y, x)

glm.fit <span style="color:#f92672">=</span> <span style="color:#a6e22e">glm</span>(y <span style="color:#f92672">~</span> <span style="color:#a6e22e">poly</span>(x, <span style="color:#ae81ff">1</span>), data <span style="color:#f92672">=</span> df)
<span style="color:#a6e22e">summary</span>(glm.fit)<span style="color:#f92672">$</span>coefficients[, <span style="color:#ae81ff">4</span>]  
</code></pre></div><pre><code>##  (Intercept)   poly(x, 1)
## 3.953542e-08 1.923846e-02
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">glm.fit <span style="color:#f92672">=</span> <span style="color:#a6e22e">glm</span>(y <span style="color:#f92672">~</span> <span style="color:#a6e22e">poly</span>(x, <span style="color:#ae81ff">2</span>), data <span style="color:#f92672">=</span> df)
<span style="color:#a6e22e">summary</span>(glm.fit)<span style="color:#f92672">$</span>coefficients[, <span style="color:#ae81ff">4</span>]
</code></pre></div><pre><code>##  (Intercept)  poly(x, 2)1  poly(x, 2)2
## 2.656229e-29 4.184810e-09 4.584330e-44
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">glm.fit <span style="color:#f92672">=</span> <span style="color:#a6e22e">glm</span>(y <span style="color:#f92672">~</span> <span style="color:#a6e22e">poly</span>(x, <span style="color:#ae81ff">3</span>), data <span style="color:#f92672">=</span> df)
<span style="color:#a6e22e">summary</span>(glm.fit)<span style="color:#f92672">$</span>coefficients[, <span style="color:#ae81ff">4</span>]
</code></pre></div><pre><code>##  (Intercept)  poly(x, 3)1  poly(x, 3)2  poly(x, 3)3
## 4.995066e-29 4.971565e-09 1.216703e-43 7.843990e-01
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">glm.fit <span style="color:#f92672">=</span> <span style="color:#a6e22e">glm</span>(y <span style="color:#f92672">~</span> <span style="color:#a6e22e">poly</span>(x, <span style="color:#ae81ff">4</span>), data <span style="color:#f92672">=</span> df)
<span style="color:#a6e22e">summary</span>(glm.fit)<span style="color:#f92672">$</span>coefficients[, <span style="color:#ae81ff">4</span>]
</code></pre></div><pre><code>##  (Intercept)  poly(x, 4)1  poly(x, 4)2  poly(x, 4)3  poly(x, 4)4
## 5.169227e-29 4.590732e-09 1.593826e-43 7.836207e-01 1.930956e-01
</code></pre>
<p><em>This analysis is based on Exercise 5.8 from &ldquo;An Introduction to Statistical Learning&rdquo; book by Robert Tibshirani and Trevor Hastie</em></p>


                <br>
            </div>
            
            
                <div class="navigation">
                    
                    <div>
                        <img class="icon" src="https://christospitsi.github.io/img/back.svg" alt="back" />
                        <a href="https://christospitsi.github.io/blog/sp-500-stock-exchange-a-for-loop-loocv-approach/">S&amp;P 500 stock exchange - A &#39;for loop&#39; LOOCV approach</a>
                    </div>
                    
                    <div style="width: 100%;"></div>
                    
                    <div>
                        <a href="https://christospitsi.github.io/blog/random-forests-in-all-shapes-and-sizes/">Random forests in all shapes and sizes</a>
                        <img class="icon" src="https://christospitsi.github.io/img/next.svg" alt="next" />
                    </div>
                    
                </div>
            
            <br>
            <div class="disqus">
                
            </div>
            
        </div>
    </div>
</div>

<div class="footer column">
    <div class="container">

        

        <div class="copyright">

        
            
                <a href="https://christospitsi.github.io/about">Copyright © 2018 Christos Pitsikas, Powered by Hugo and Cocoa-Eh</a>
            
        

        </div>
        <div class="icons">

        

        
            <a href="https://github.com/christospitsi" target="_blank">
                <img class="icon" src="https://christospitsi.github.io/img/github.svg" alt="github" />
            </a>
        

        

        
            <a href="https://www.linkedin.com/in/christos-pitsikas-0b817830" target="_blank">
                <img class="icon" src="https://christospitsi.github.io/img/linkedin.svg" alt="linkedin" />
            </a>
        

        
            <a href="mailto:christos.pitsikas@gmail.com">
                <img class="icon" src="https://christospitsi.github.io/img/email.svg" alt="email" />
            </a>
        

        
            <a href="https://christospitsi.github.io/index.xml">
                <img class="icon" src="https://christospitsi.github.io/img/rss.svg" alt="rss" />
            </a>
        

        </div>
    </div>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js"></script>
<script>
  WebFont.load({
    google: {
      families: ['Raleway:400,600,700', 'Merriweather:300,300i,700,700i', 'Ubuntu+Mono:400,700']
    }
  });
</script>


  <script src="https://christospitsi.github.io/js/highlight.min.js" defer></script>
  



  <script src="https://christospitsi.github.io/js/progressively.min.js" defer></script>









<script>
  window.onload = function() {
    
      hljs.initHighlighting();
    
    
      progressively.init({delay: 30, throttle: 50});
    
    
  };
</script>


</body>
</html>

